{
  "info": {
    "_postman_id": "document-management-service",
    "name": "Document Management Service",
    "description": "# Document Management Service API\n\nA robust microservice for managing document categories, types, file uploads, and user documents with multi-tenancy support.\n\n## Features\n- Multi-tenant architecture (agency-based)\n- Two-phase file upload (temp -> permanent)\n- Document versioning\n- Virus scanning on uploads\n- Soft delete with audit trails\n- Comprehensive document type validation\n\n## Authentication\nCurrently no authentication required (add your auth middleware as needed).\n\n## Base URL\n`http://localhost:3005/api/v1/documents-management`",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3005/api/v1/documents-management",
      "type": "string"
    },
    {
      "key": "agencyId",
      "value": "agency-001",
      "type": "string"
    },
    {
      "key": "userId",
      "value": "user-001",
      "type": "string"
    },
    {
      "key": "categoryId",
      "value": "",
      "type": "string"
    },
    {
      "key": "documentTypeId",
      "value": "",
      "type": "string"
    },
    {
      "key": "documentId",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Document Categories",
      "description": "APIs for managing document categories. Categories are used to organize document types into logical groups (e.g., \"Identity Documents\", \"Educational Documents\").",
      "item": [
        {
          "name": "Create Category",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"agencyId\": \"{{agencyId}}\",\n  \"name\": \"Identity Documents\",\n  \"description\": \"Government-issued identity documents\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/documents-category",
              "host": ["{{baseUrl}}"],
              "path": ["documents-category"]
            },
            "description": "# Create Category\n\n`POST` `/documents-category`\n\nCreates a new document category for an agency.\n\n---\n\n## Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| agencyId | string | Yes | Unique identifier for the agency |\n| name | string | Yes | Category name (must be unique per agency) |\n| description | string | No | Optional description of the category |\n\n---\n\n## Success Response (201)\n\n```json\n{\n  \"statusCode\": 201,\n  \"success\": true,\n  \"message\": \"Category created successfully\",\n  \"data\": {\n    \"id\": \"uuid\",\n    \"agencyId\": \"string\",\n    \"name\": \"string\",\n    \"description\": \"string\",\n    \"createdAt\": \"datetime\",\n    \"updatedAt\": \"datetime\"\n  }\n}\n```\n\n---\n\n## Error Responses\n\n**409 Conflict** - Category with same name already exists\n```json\n{\n  \"statusCode\": 409,\n  \"success\": false,\n  \"message\": \"Category already exists\"\n}\n```\n\n**400 Bad Request** - Missing required fields\n```json\n{\n  \"statusCode\": 400,\n  \"success\": false,\n  \"message\": \"agencyId is required\"\n}\n```"
          },
          "response": []
        },
        {
          "name": "Get All Categories",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/documents-category/{{agencyId}}?page=1&limit=10&sortBy=createdAt&sortOrder=desc&search=",
              "host": ["{{baseUrl}}"],
              "path": ["documents-category", "{{agencyId}}"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "sortBy",
                  "value": "createdAt"
                },
                {
                  "key": "sortOrder",
                  "value": "desc"
                },
                {
                  "key": "search",
                  "value": ""
                }
              ]
            },
            "description": "# Get All Categories\n\n`GET` `/documents-category/:agencyId`\n\nRetrieves all categories for an agency with pagination and search support.\n\n---\n\n## Path Parameters\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| agencyId | string | Yes | Agency identifier |\n\n---\n\n## Query Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| page | number | 1 | Page number for pagination |\n| limit | number | 10 | Number of items per page |\n| sortBy | string | createdAt | Field to sort by (name, createdAt) |\n| sortOrder | string | desc | Sort order (asc, desc) |\n| search | string | \"\" | Search term for name or description |\n\n---\n\n## Success Response (200)\n\n```json\n{\n  \"statusCode\": 200,\n  \"success\": true,\n  \"message\": \"Categories fetched successfully\",\n  \"meta\": {\n    \"page\": 1,\n    \"limit\": 10,\n    \"total\": 25\n  },\n  \"data\": [\n    {\n      \"id\": \"uuid\",\n      \"agencyId\": \"string\",\n      \"name\": \"Identity Documents\",\n      \"description\": \"Government-issued identity documents\",\n      \"documentTypes\": [\n        {\n          \"id\": \"uuid\",\n          \"name\": \"Passport\"\n        }\n      ]\n    }\n  ]\n}\n```"
          },
          "response": []
        },
        {
          "name": "Get Category by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/documents-category/{{agencyId}}/{{categoryId}}",
              "host": ["{{baseUrl}}"],
              "path": ["documents-category", "{{agencyId}}", "{{categoryId}}"]
            },
            "description": "# Get Category by ID\n\n`GET` `/documents-category/:agencyId/:categoryId`\n\nRetrieves a single category by its ID.\n\n---\n\n## Path Parameters\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| agencyId | string | Yes | Agency identifier |\n| categoryId | string | Yes | Category UUID |\n\n---\n\n## Success Response (200)\n\n```json\n{\n  \"statusCode\": 200,\n  \"success\": true,\n  \"message\": \"Category fetched successfully\",\n  \"data\": {\n    \"id\": \"uuid\",\n    \"agencyId\": \"string\",\n    \"name\": \"Identity Documents\",\n    \"description\": \"Government-issued identity documents\",\n    \"createdAt\": \"datetime\",\n    \"updatedAt\": \"datetime\"\n  }\n}\n```\n\n---\n\n## Error Response (404)\n\n```json\n{\n  \"statusCode\": 404,\n  \"success\": false,\n  \"message\": \"Category not found\"\n}\n```"
          },
          "response": []
        },
        {
          "name": "Update Category",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Updated Category Name\",\n  \"description\": \"Updated description\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/documents-category/{{agencyId}}/{{categoryId}}",
              "host": ["{{baseUrl}}"],
              "path": ["documents-category", "{{agencyId}}", "{{categoryId}}"]
            },
            "description": "# Update Category\n\n`PATCH` `/documents-category/:agencyId/:categoryId`\n\nUpdates an existing category. Only provided fields will be updated.\n\n---\n\n## Path Parameters\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| agencyId | string | Yes | Agency identifier |\n| categoryId | string | Yes | Category UUID |\n\n---\n\n## Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| name | string | No | New category name |\n| description | string | No | New description |\n\n---\n\n## Success Response (200)\n\n```json\n{\n  \"statusCode\": 200,\n  \"success\": true,\n  \"message\": \"Category updated successfully\",\n  \"data\": {\n    \"id\": \"uuid\",\n    \"agencyId\": \"string\",\n    \"name\": \"Updated Category Name\",\n    \"description\": \"Updated description\",\n    \"updatedAt\": \"datetime\"\n  }\n}\n```\n\n---\n\n## Error Responses\n\n- **404 Not Found** - Category doesn't exist\n- **409 Conflict** - New name conflicts with existing category"
          },
          "response": []
        },
        {
          "name": "Delete Category",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/documents-category/{{agencyId}}/{{categoryId}}",
              "host": ["{{baseUrl}}"],
              "path": ["documents-category", "{{agencyId}}", "{{categoryId}}"]
            },
            "description": "# Delete Category\n\n`DELETE` `/documents-category/:agencyId/:categoryId`\n\nSoft deletes a category (sets deletedAt timestamp). The category will no longer appear in listings but is preserved in the database for audit purposes.\n\n---\n\n## Path Parameters\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| agencyId | string | Yes | Agency identifier |\n| categoryId | string | Yes | Category UUID |\n\n---\n\n## Success Response (200)\n\n```json\n{\n  \"statusCode\": 200,\n  \"success\": true,\n  \"message\": \"Category deleted successfully\",\n  \"data\": {\n    \"id\": \"uuid\",\n    \"deletedAt\": \"datetime\"\n  }\n}\n```\n\n---\n\n## Error Response (404)\n\n```json\n{\n  \"statusCode\": 404,\n  \"success\": false,\n  \"message\": \"Category not found\"\n}\n```\n\n---\n\n## Notes\n- This is a soft delete operation\n- Associated document types are NOT automatically deleted\n- Audit logs are preserved"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Document Types",
      "description": "APIs for managing document type requirements. Document types define what documents users need to upload (e.g., \"Passport\", \"Driver's License\") and their validation rules.",
      "item": [
        {
          "name": "Create Document Type",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Passport\",\n  \"description\": \"Valid passport document\",\n  \"isRequired\": true,\n  \"allowedExtensions\": [\"pdf\", \"jpg\", \"png\"]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/document-type/{{agencyId}}/{{categoryId}}",
              "host": ["{{baseUrl}}"],
              "path": ["document-type", "{{agencyId}}", "{{categoryId}}"]
            },
            "description": "# Create Document Type\n\n`POST` `/document-type/:agencyId/:categoryId`\n\nCreates a new document type requirement within a category.\n\n---\n\n## Path Parameters\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| agencyId | string | Yes | Agency identifier |\n| categoryId | string | Yes | Category UUID to add this type to |\n\n---\n\n## Request Body\n\n| Field | Type | Required | Default | Description |\n|-------|------|----------|---------|-------------|\n| name | string | Yes | - | Document type name (unique per category) |\n| description | string | No | null | Description of the document type |\n| isRequired | boolean | No | false | Whether this document is mandatory |\n| allowedExtensions | string[] | No | [] | Allowed file extensions (e.g., [\"pdf\", \"jpg\"]) |\n\n---\n\n## Success Response (201)\n\n```json\n{\n  \"statusCode\": 201,\n  \"success\": true,\n  \"message\": \"Document type added successfully\",\n  \"data\": {\n    \"id\": \"uuid\",\n    \"agencyId\": \"string\",\n    \"categoryId\": \"uuid\",\n    \"name\": \"Passport\",\n    \"description\": \"Valid passport document\",\n    \"isRequired\": true,\n    \"allowedExtensions\": [\"pdf\", \"jpg\", \"png\"],\n    \"createdAt\": \"datetime\"\n  }\n}\n```\n\n---\n\n## Error Responses\n\n- **404 Not Found** - Category doesn't exist\n- **409 Conflict** - Document type with same name already exists in this category"
          },
          "response": []
        },
        {
          "name": "Get Document Types by Category",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/document-type/{{agencyId}}/{{categoryId}}/list?page=1&limit=10&sortBy=createdAt&sortOrder=desc",
              "host": ["{{baseUrl}}"],
              "path": ["document-type", "{{agencyId}}", "{{categoryId}}", "list"],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "sortBy",
                  "value": "createdAt"
                },
                {
                  "key": "sortOrder",
                  "value": "desc"
                }
              ]
            },
            "description": "# Get Document Types by Category\n\n`GET` `/document-type/:agencyId/:categoryId/list`\n\nRetrieves all document types within a specific category with pagination.\n\n---\n\n## Path Parameters\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| agencyId | string | Yes | Agency identifier |\n| categoryId | string | Yes | Category UUID |\n\n---\n\n## Query Parameters\n\n| Parameter | Type | Default | Description |\n|-----------|------|---------|-------------|\n| page | number | 1 | Page number |\n| limit | number | 10 | Items per page |\n| sortBy | string | createdAt | Field to sort by |\n| sortOrder | string | desc | Sort order (asc, desc) |\n\n---\n\n## Success Response (200)\n\n```json\n{\n  \"statusCode\": 200,\n  \"success\": true,\n  \"message\": \"Document types fetched\",\n  \"meta\": {\n    \"page\": 1,\n    \"limit\": 10,\n    \"total\": 5\n  },\n  \"data\": [\n    {\n      \"id\": \"uuid\",\n      \"name\": \"Passport\",\n      \"description\": \"Valid passport document\",\n      \"isRequired\": true,\n      \"allowedExtensions\": [\"pdf\", \"jpg\", \"png\"]\n    }\n  ]\n}\n```"
          },
          "response": []
        },
        {
          "name": "Get Document Types Grouped by Category",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/document-type/{{agencyId}}/grouped",
              "host": ["{{baseUrl}}"],
              "path": ["document-type", "{{agencyId}}", "grouped"]
            },
            "description": "# Get Document Types Grouped by Category\n\n`GET` `/document-type/:agencyId/grouped`\n\nRetrieves all document types for an agency, grouped by their parent categories. Useful for displaying a complete document requirements checklist.\n\n---\n\n## Path Parameters\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| agencyId | string | Yes | Agency identifier |\n\n---\n\n## Success Response (200)\n\n```json\n{\n  \"statusCode\": 200,\n  \"success\": true,\n  \"message\": \"Document types grouped by categories fetched\",\n  \"data\": [\n    {\n      \"categoryId\": \"uuid\",\n      \"categoryName\": \"Identity Documents\",\n      \"categoryDescription\": \"Government-issued identity documents\",\n      \"documentTypes\": [\n        {\n          \"id\": \"uuid\",\n          \"name\": \"Passport\",\n          \"description\": \"Valid passport document\",\n          \"isRequired\": true,\n          \"allowedExtensions\": [\"pdf\", \"jpg\", \"png\"]\n        },\n        {\n          \"id\": \"uuid\",\n          \"name\": \"Driver's License\",\n          \"isRequired\": false,\n          \"allowedExtensions\": [\"pdf\", \"jpg\"]\n        }\n      ]\n    }\n  ]\n}\n```\n\n---\n\n## Use Cases\n- Building document upload forms\n- Displaying document checklists\n- Validating user document submissions"
          },
          "response": []
        },
        {
          "name": "Get Document Type by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/document-type/{{agencyId}}/{{documentTypeId}}",
              "host": ["{{baseUrl}}"],
              "path": ["document-type", "{{agencyId}}", "{{documentTypeId}}"]
            },
            "description": "# Get Document Type by ID\n\n`GET` `/document-type/:agencyId/:documentTypeId`\n\nRetrieves a single document type by its ID.\n\n---\n\n## Path Parameters\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| agencyId | string | Yes | Agency identifier |\n| documentTypeId | string | Yes | Document type UUID |\n\n---\n\n## Success Response (200)\n\n```json\n{\n  \"statusCode\": 200,\n  \"success\": true,\n  \"message\": \"Document type fetched\",\n  \"data\": {\n    \"id\": \"uuid\",\n    \"agencyId\": \"string\",\n    \"categoryId\": \"uuid\",\n    \"name\": \"Passport\",\n    \"description\": \"Valid passport document\",\n    \"isRequired\": true,\n    \"allowedExtensions\": [\"pdf\", \"jpg\", \"png\"],\n    \"createdAt\": \"datetime\",\n    \"updatedAt\": \"datetime\"\n  }\n}\n```\n\n---\n\n## Error Response (404)\n\n```json\n{\n  \"statusCode\": 404,\n  \"success\": false,\n  \"message\": \"Document type not found\"\n}\n```"
          },
          "response": []
        },
        {
          "name": "Update Document Type",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Updated Document Type\",\n  \"description\": \"Updated description\",\n  \"isRequired\": false,\n  \"allowedExtensions\": [\"pdf\", \"jpg\", \"png\", \"jpeg\"]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/document-type/{{agencyId}}/{{documentTypeId}}",
              "host": ["{{baseUrl}}"],
              "path": ["document-type", "{{agencyId}}", "{{documentTypeId}}"]
            },
            "description": "# Update Document Type\n\n`PATCH` `/document-type/:agencyId/:documentTypeId`\n\nUpdates an existing document type. Only provided fields will be updated.\n\n---\n\n## Path Parameters\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| agencyId | string | Yes | Agency identifier |\n| documentTypeId | string | Yes | Document type UUID |\n\n---\n\n## Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| name | string | No | New name |\n| description | string | No | New description |\n| isRequired | boolean | No | Update required status |\n| allowedExtensions | string[] | No | New allowed extensions |\n\n---\n\n## Success Response (200)\n\n```json\n{\n  \"statusCode\": 200,\n  \"success\": true,\n  \"message\": \"Document type updated successfully\",\n  \"data\": {\n    \"id\": \"uuid\",\n    \"name\": \"Updated Document Type\",\n    \"allowedExtensions\": [\"pdf\", \"jpg\", \"png\", \"jpeg\"],\n    \"updatedAt\": \"datetime\"\n  }\n}\n```\n\n---\n\n## Notes\n- Updating allowedExtensions replaces the entire array\n- Existing documents are not affected by extension changes"
          },
          "response": []
        },
        {
          "name": "Delete Document Type",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/document-type/{{agencyId}}/{{documentTypeId}}",
              "host": ["{{baseUrl}}"],
              "path": ["document-type", "{{agencyId}}", "{{documentTypeId}}"]
            },
            "description": "# Delete Document Type\n\n`DELETE` `/document-type/:agencyId/:documentTypeId`\n\nSoft deletes a document type.\n\n---\n\n## Path Parameters\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| agencyId | string | Yes | Agency identifier |\n| documentTypeId | string | Yes | Document type UUID |\n\n---\n\n## Success Response (200)\n\n```json\n{\n  \"statusCode\": 200,\n  \"success\": true,\n  \"message\": \"Document type deleted successfully\",\n  \"data\": {\n    \"id\": \"uuid\",\n    \"deletedAt\": \"datetime\"\n  }\n}\n```\n\n---\n\n## Notes\n- This is a soft delete\n- Existing user documents of this type are NOT deleted\n- The document type will no longer appear in listings"
          },
          "response": []
        }
      ]
    },
    {
      "name": "File Upload",
      "description": "APIs for handling file uploads. Files are first uploaded to temporary storage, then finalized when creating documents. This two-phase approach allows for virus scanning and validation before permanent storage.",
      "item": [
        {
          "name": "Upload Single File",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "files",
                  "type": "file",
                  "src": "",
                  "description": "Select a file to upload"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/upload",
              "host": ["{{baseUrl}}"],
              "path": ["upload"]
            },
            "description": "# Upload Single File\n\n`POST` `/upload`\n\nUploads a single file to temporary storage. The file will be virus scanned (if ClamAV is configured) before being accepted.\n\n---\n\n## Request\n\n**Content-Type:** `multipart/form-data`\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| files | File | Yes | The file to upload |\n\n---\n\n## Success Response (200)\n\n```json\n{\n  \"statusCode\": 200,\n  \"success\": true,\n  \"message\": \"File uploaded successfully\",\n  \"data\": {\n    \"tempPath\": \"temp/abc123_filename.pdf\",\n    \"filename\": \"abc123_filename.pdf\",\n    \"originalName\": \"my-document.pdf\",\n    \"size\": 102400,\n    \"sizeKB\": 100,\n    \"extension\": \"pdf\"\n  }\n}\n```\n\n---\n\n## Error Responses\n\n**400 Bad Request** - No file provided\n```json\n{\n  \"statusCode\": 400,\n  \"success\": false,\n  \"message\": \"No files were uploaded\"\n}\n```\n\n**400 Bad Request** - Virus detected\n```json\n{\n  \"statusCode\": 400,\n  \"success\": false,\n  \"message\": \"File(s) rejected due to security scan\",\n  \"data\": {\n    \"rejectedFiles\": [\"infected-file.pdf\"],\n    \"reason\": \"Potential malware detected or scan failed\"\n  }\n}\n```\n\n---\n\n## Notes\n- Files are stored in `uploads/temp/` directory\n- Temp files are automatically cleaned up after 24 hours\n- Use the returned `tempPath` when creating documents\n- Maximum file size: 5MB (configurable)\n\n---\n\n## Virus Scanning\n- Files are scanned using ClamAV if configured\n- If ClamAV is unavailable, uploads proceed with a warning\n- Infected files are rejected and quarantined"
          },
          "response": []
        },
        {
          "name": "Upload Multiple Files",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "files",
                  "type": "file",
                  "src": "",
                  "description": "Select first file"
                },
                {
                  "key": "files",
                  "type": "file",
                  "src": "",
                  "description": "Select second file"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/upload",
              "host": ["{{baseUrl}}"],
              "path": ["upload"]
            },
            "description": "# Upload Multiple Files\n\n`POST` `/upload`\n\nUploads multiple files to temporary storage in a single request.\n\n---\n\n## Request\n\n**Content-Type:** `multipart/form-data`\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| files | File[] | Yes | Array of files to upload |\n\n---\n\n## Success Response (200)\n\n```json\n{\n  \"statusCode\": 200,\n  \"success\": true,\n  \"message\": \"Files uploaded successfully\",\n  \"data\": [\n    {\n      \"tempPath\": \"temp/abc123_passport.pdf\",\n      \"filename\": \"abc123_passport.pdf\",\n      \"originalName\": \"passport.pdf\",\n      \"size\": 102400,\n      \"sizeKB\": 100,\n      \"extension\": \"pdf\"\n    },\n    {\n      \"tempPath\": \"temp/def456_photo.jpg\",\n      \"filename\": \"def456_photo.jpg\",\n      \"originalName\": \"photo.jpg\",\n      \"size\": 51200,\n      \"sizeKB\": 50,\n      \"extension\": \"jpg\"\n    }\n  ]\n}\n```\n\n---\n\n## Partial Success Response\n\nIf some files pass virus scan and others fail:\n\n```json\n{\n  \"statusCode\": 200,\n  \"success\": true,\n  \"message\": \"2 file(s) uploaded, 1 rejected\",\n  \"data\": {\n    \"uploaded\": [...],\n    \"rejected\": [\"infected-file.pdf\"]\n  }\n}\n```"
          },
          "response": []
        },
        {
          "name": "Delete Temp Files",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"tempPaths\": [\n    \"temp/abc123_filename.pdf\",\n    \"temp/def456_another.jpg\"\n  ]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/upload/temp",
              "host": ["{{baseUrl}}"],
              "path": ["upload", "temp"]
            },
            "description": "# Delete Temp Files\n\n`DELETE` `/upload/temp`\n\nManually deletes files from temporary storage. Use this to clean up uploaded files that won't be finalized.\n\n---\n\n## Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| tempPaths | string[] | Yes | Array of temp file paths to delete |\n\n---\n\n## Success Response (200)\n\n```json\n{\n  \"statusCode\": 200,\n  \"success\": true,\n  \"message\": \"2 file(s) deleted successfully\",\n  \"data\": {\n    \"deletedCount\": 2,\n    \"failedCount\": 0\n  }\n}\n```\n\n---\n\n## Error Response (400)\n\n```json\n{\n  \"statusCode\": 400,\n  \"success\": false,\n  \"message\": \"No temp paths provided\"\n}\n```\n\n---\n\n## Notes\n- Non-existent files are silently skipped\n- Temp files are automatically cleaned up after 24 hours\n- Use this for immediate cleanup if user cancels upload"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Documents",
      "description": "APIs for managing user documents. Documents are the actual files uploaded by users, linked to document types and stored permanently with versioning support.",
      "item": [
        {
          "name": "Create Documents (Finalize Upload)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"agencyId\": \"{{agencyId}}\",\n  \"userId\": \"{{userId}}\",\n  \"userType\": \"STUDENT\",\n  \"createdBy\": \"{{userId}}\",\n  \"documents\": [\n    {\n      \"documentTypeId\": \"{{documentTypeId}}\",\n      \"tempPath\": \"temp/abc123_passport.pdf\",\n      \"originalName\": \"my-passport.pdf\",\n      \"size\": 102400,\n      \"extension\": \"pdf\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/documents",
              "host": ["{{baseUrl}}"],
              "path": ["documents"]
            },
            "description": "# Create Documents (Finalize Upload)\n\n`POST` `/documents`\n\nFinalizes the upload process by:\n1. Validating temp files exist\n2. Validating document types and extensions\n3. Moving files from temp to permanent storage\n4. Creating database records with versioning\n5. Creating audit logs\n\n---\n\n## Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| agencyId | string | Yes | Agency identifier |\n| userId | string | Yes | User identifier |\n| userType | enum | Yes | STUDENT, COUNSELOR, ADMIN, OTHER |\n| createdBy | string | Yes | ID of user creating the document |\n| documents | array | Yes | Array of documents to create |\n\n### Document Object\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| documentTypeId | string | Yes | Document type UUID |\n| tempPath | string | Yes | Temp file path from upload response |\n| originalName | string | Yes | Original filename |\n| size | number | Yes | File size in bytes |\n| extension | string | Yes | File extension (without dot) |\n\n---\n\n## Success Response (201)\n\n```json\n{\n  \"statusCode\": 201,\n  \"success\": true,\n  \"message\": \"Documents created successfully\",\n  \"data\": [\n    {\n      \"id\": \"uuid\",\n      \"documentTypeId\": \"uuid\",\n      \"fileUrl\": \"permanent/agency/STUDENT/user/docType/v1_timestamp_file.pdf\",\n      \"fileSize\": 102400,\n      \"fileExtension\": \"pdf\",\n      \"status\": \"DRAFT\",\n      \"versionNumber\": 1,\n      \"createdAt\": \"datetime\"\n    }\n  ]\n}\n```\n\n---\n\n## Error Responses\n\n**400 Bad Request** - Temp file not found\n```json\n{\n  \"statusCode\": 400,\n  \"success\": false,\n  \"message\": \"Temp file not found\"\n}\n```\n\n**400 Bad Request** - Invalid extension\n```json\n{\n  \"statusCode\": 400,\n  \"success\": false,\n  \"message\": \"Invalid file extension\",\n  \"errorMessages\": [{\n    \"path\": \"document.exe\",\n    \"message\": \"Extension 'exe' is not allowed for Passport\"\n  }]\n}\n```\n\n**409 Conflict** - Document already exists\n```json\n{\n  \"statusCode\": 409,\n  \"success\": false,\n  \"message\": \"Document already exists\"\n}\n```\n\n---\n\n## File Storage Structure\n\n```\nuploads/permanent/{agencyId}/{userType}/{userId}/{documentTypeId}/v{version}_{timestamp}_{filename}\n```\n\n---\n\n## Notes\n- Each user can only have ONE document per document type\n- Use Update endpoint for replacements\n- Version 1 is created automatically\n- Audit log entry is created"
          },
          "response": []
        },
        {
          "name": "Get User Documents",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/documents/{{agencyId}}/user/{{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["documents", "{{agencyId}}", "user", "{{userId}}"]
            },
            "description": "# Get User Documents\n\n`GET` `/documents/:agencyId/user/:userId`\n\nRetrieves all documents for a specific user within an agency.\n\n---\n\n## Path Parameters\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| agencyId | string | Yes | Agency identifier |\n| userId | string | Yes | User identifier |\n\n---\n\n## Success Response (200)\n\n```json\n{\n  \"statusCode\": 200,\n  \"success\": true,\n  \"message\": \"Documents fetched successfully\",\n  \"data\": [\n    {\n      \"id\": \"uuid\",\n      \"agencyId\": \"string\",\n      \"documentTypeId\": \"uuid\",\n      \"userType\": \"STUDENT\",\n      \"userId\": \"string\",\n      \"currentVersionId\": \"uuid\",\n      \"status\": \"DRAFT\",\n      \"versionNumber\": 2,\n      \"fileUrl\": \"permanent/.../v2_timestamp_file.pdf\",\n      \"fileSize\": 102400,\n      \"fileExtension\": \"pdf\",\n      \"createdAt\": \"datetime\",\n      \"updatedAt\": \"datetime\",\n      \"currentVersion\": {\n        \"id\": \"uuid\",\n        \"versionNumber\": 2,\n        \"fileUrl\": \"...\",\n        \"uploadedBy\": \"user-id\",\n        \"uploadedAt\": \"datetime\"\n      },\n      \"documentType\": {\n        \"id\": \"uuid\",\n        \"name\": \"Passport\",\n        \"isRequired\": true,\n        \"allowedExtensions\": [\"pdf\", \"jpg\", \"png\"]\n      }\n    }\n  ]\n}\n```\n\n---\n\n## Notes\n- Only returns non-deleted documents\n- Includes current version details\n- Includes document type information\n- Ordered by createdAt (newest first)"
          },
          "response": []
        },
        {
          "name": "Get Document by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/documents/{{agencyId}}/{{documentId}}",
              "host": ["{{baseUrl}}"],
              "path": ["documents", "{{agencyId}}", "{{documentId}}"]
            },
            "description": "# Get Document by ID\n\n`GET` `/documents/:agencyId/:documentId`\n\nRetrieves a single document by its ID.\n\n---\n\n## Path Parameters\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| agencyId | string | Yes | Agency identifier |\n| documentId | string | Yes | Document UUID |\n\n---\n\n## Success Response (200)\n\n```json\n{\n  \"statusCode\": 200,\n  \"success\": true,\n  \"message\": \"Document fetched successfully\",\n  \"data\": {\n    \"id\": \"uuid\",\n    \"agencyId\": \"string\",\n    \"documentTypeId\": \"uuid\",\n    \"userType\": \"STUDENT\",\n    \"userId\": \"string\",\n    \"status\": \"DRAFT\",\n    \"versionNumber\": 1,\n    \"fileUrl\": \"permanent/.../v1_timestamp_file.pdf\",\n    \"fileSize\": 102400,\n    \"fileExtension\": \"pdf\",\n    \"currentVersion\": {...},\n    \"documentType\": {...}\n  }\n}\n```\n\n---\n\n## Error Response (404)\n\n```json\n{\n  \"statusCode\": 404,\n  \"success\": false,\n  \"message\": \"Document not found\"\n}\n```"
          },
          "response": []
        },
        {
          "name": "Update Document (New Version)",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"tempPath\": \"temp/abc123_newfile.pdf\",\n  \"originalName\": \"updated-passport.pdf\",\n  \"size\": 204800,\n  \"extension\": \"pdf\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/documents/{{agencyId}}/user/{{userId}}/{{documentId}}",
              "host": ["{{baseUrl}}"],
              "path": ["documents", "{{agencyId}}", "user", "{{userId}}", "{{documentId}}"]
            },
            "description": "# Update Document (New Version)\n\n`PATCH` `/documents/:agencyId/user/:userId/:documentId`\n\nReplaces an existing document with a new version. This creates a new version record while preserving the previous version history.\n\n---\n\n## Workflow\n1. Upload the new file using `POST /upload`\n2. Call this endpoint with the new file's tempPath\n3. System creates new version, updates document, preserves history\n\n---\n\n## Path Parameters\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| agencyId | string | Yes | Agency identifier |\n| userId | string | Yes | User identifier (ownership verification) |\n| documentId | string | Yes | Document UUID to update |\n\n---\n\n## Request Body\n\n| Field | Type | Required | Description |\n|-------|------|----------|-------------|\n| tempPath | string | Yes | Temp file path from upload response |\n| originalName | string | Yes | Original filename of new file |\n| size | number | Yes | File size in bytes |\n| extension | string | Yes | File extension (must be allowed) |\n\n---\n\n## Success Response (200)\n\n```json\n{\n  \"statusCode\": 200,\n  \"success\": true,\n  \"message\": \"Document updated successfully\",\n  \"data\": {\n    \"id\": \"uuid\",\n    \"documentTypeId\": \"uuid\",\n    \"fileUrl\": \"permanent/.../v2_timestamp_newfile.pdf\",\n    \"fileSize\": 204800,\n    \"fileExtension\": \"pdf\",\n    \"status\": \"DRAFT\",\n    \"versionNumber\": 2,\n    \"createdAt\": \"datetime\"\n  }\n}\n```\n\n---\n\n## Error Responses\n\n**400 Bad Request** - Temp file not found\n```json\n{\n  \"statusCode\": 400,\n  \"success\": false,\n  \"message\": \"Temp file not found\"\n}\n```\n\n**400 Bad Request** - Invalid extension\n```json\n{\n  \"statusCode\": 400,\n  \"success\": false,\n  \"message\": \"Invalid file extension\"\n}\n```\n\n**404 Not Found** - Document not found or doesn't belong to user\n```json\n{\n  \"statusCode\": 404,\n  \"success\": false,\n  \"message\": \"Document not found\"\n}\n```\n\n---\n\n## Versioning\n- Each update increments versionNumber\n- Previous files are preserved (not deleted)\n- New version record created in DocumentVersion table\n- Audit log entry created with action \"UPDATED\""
          },
          "response": []
        },
        {
          "name": "Delete Document",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/documents/{{agencyId}}/user/{{userId}}/{{documentId}}",
              "host": ["{{baseUrl}}"],
              "path": ["documents", "{{agencyId}}", "user", "{{userId}}", "{{documentId}}"]
            },
            "description": "# Delete Document\n\n`DELETE` `/documents/:agencyId/user/:userId/:documentId`\n\nSoft deletes a document and removes the file from storage. The document record is preserved in the database with a deletedAt timestamp for audit purposes.\n\n---\n\n## Path Parameters\n\n| Parameter | Type | Required | Description |\n|-----------|------|----------|-------------|\n| agencyId | string | Yes | Agency identifier |\n| userId | string | Yes | User identifier (ownership verification) |\n| documentId | string | Yes | Document UUID |\n\n---\n\n## Success Response (200)\n\n```json\n{\n  \"statusCode\": 200,\n  \"success\": true,\n  \"message\": \"Document deleted successfully\",\n  \"data\": {\n    \"deleted\": true\n  }\n}\n```\n\n---\n\n## Error Response (404)\n\n```json\n{\n  \"statusCode\": 404,\n  \"success\": false,\n  \"message\": \"Document not found\"\n}\n```\n\n---\n\n## What Happens\n1. Verifies document exists and belongs to user\n2. Deletes the physical file from permanent storage\n3. Sets deletedAt timestamp on document record (soft delete)\n4. Creates audit log entry with action \"DELETED\"\n\n---\n\n## Notes\n- This is a soft delete - record remains in database\n- Physical file IS deleted from storage\n- Audit logs are preserved\n- Document versions are preserved\n- Document will no longer appear in listings"
          },
          "response": []
        }
      ]
    },
    {
      "name": "Workflow Examples",
      "description": "Step-by-step example workflows for common use cases. Follow these requests in order to complete a full document upload flow.",
      "item": [
        {
          "name": "1. Create Category",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"agencyId\": \"{{agencyId}}\",\n  \"name\": \"Identity Documents\",\n  \"description\": \"Government-issued identity documents\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/documents-category",
              "host": ["{{baseUrl}}"],
              "path": ["documents-category"]
            },
            "description": "# Step 1: Create a Category\n\n`POST` `/documents-category`\n\nFirst, create a document category to organize your document types.\n\n---\n\n## After Success\n\nCopy the `id` from the response and set it as the `categoryId` variable for the next step.\n\n```json\nResponse: { \"data\": { \"id\": \"copy-this-uuid\" } }\n```"
          },
          "response": []
        },
        {
          "name": "2. Create Document Type",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Passport\",\n  \"description\": \"Valid passport document\",\n  \"isRequired\": true,\n  \"allowedExtensions\": [\"pdf\", \"jpg\", \"png\"]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/document-type/{{agencyId}}/{{categoryId}}",
              "host": ["{{baseUrl}}"],
              "path": ["document-type", "{{agencyId}}", "{{categoryId}}"]
            },
            "description": "# Step 2: Create a Document Type\n\n`POST` `/document-type/:agencyId/:categoryId`\n\nCreate a document type requirement within the category.\n\n---\n\n## Prerequisites\n- Set `categoryId` variable from Step 1\n\n---\n\n## After Success\n\nCopy the `id` from the response and set it as the `documentTypeId` variable.\n\n```json\nResponse: { \"data\": { \"id\": \"copy-this-uuid\" } }\n```"
          },
          "response": []
        },
        {
          "name": "3. Upload File to Temp",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "formdata",
              "formdata": [
                {
                  "key": "files",
                  "type": "file",
                  "src": "",
                  "description": "Select your passport file"
                }
              ]
            },
            "url": {
              "raw": "{{baseUrl}}/upload",
              "host": ["{{baseUrl}}"],
              "path": ["upload"]
            },
            "description": "# Step 3: Upload File to Temporary Storage\n\n`POST` `/upload`\n\nUpload your document file. The file will be virus scanned and stored temporarily.\n\n---\n\n## After Success\n\nCopy the `tempPath` from the response - you'll need it in Step 4.\n\n```json\nResponse: {\n  \"data\": {\n    \"tempPath\": \"temp/abc123_passport.pdf\",  // <-- Copy this\n    \"originalName\": \"passport.pdf\",\n    \"size\": 102400,\n    \"extension\": \"pdf\"\n  }\n}\n```"
          },
          "response": []
        },
        {
          "name": "4. Finalize Document",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"agencyId\": \"{{agencyId}}\",\n  \"userId\": \"{{userId}}\",\n  \"userType\": \"STUDENT\",\n  \"createdBy\": \"{{userId}}\",\n  \"documents\": [\n    {\n      \"documentTypeId\": \"{{documentTypeId}}\",\n      \"tempPath\": \"temp/YOUR_TEMP_PATH_HERE\",\n      \"originalName\": \"passport.pdf\",\n      \"size\": 102400,\n      \"extension\": \"pdf\"\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/documents",
              "host": ["{{baseUrl}}"],
              "path": ["documents"]
            },
            "description": "# Step 4: Finalize the Document\n\n`POST` `/documents`\n\nCreate the document record and move the file to permanent storage.\n\n---\n\n## Prerequisites\n- Set `documentTypeId` variable from Step 2\n- Replace `YOUR_TEMP_PATH_HERE` with the `tempPath` from Step 3\n- Update `size` and `extension` to match your actual file\n\n---\n\n## After Success\n\nCopy the `id` from the response and set it as the `documentId` variable.\n\n```json\nResponse: {\n  \"data\": [{\n    \"id\": \"copy-this-uuid\",  // <-- This is your documentId\n    \"versionNumber\": 1,\n    \"status\": \"DRAFT\"\n  }]\n}\n```"
          },
          "response": []
        },
        {
          "name": "5. View User Documents",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/documents/{{agencyId}}/user/{{userId}}",
              "host": ["{{baseUrl}}"],
              "path": ["documents", "{{agencyId}}", "user", "{{userId}}"]
            },
            "description": "# Step 5: View User Documents\n\n`GET` `/documents/:agencyId/user/:userId`\n\nVerify the document was created by fetching all documents for the user.\n\n---\n\n## Expected Result\n\nYou should see your newly created document with:\n- `versionNumber: 1`\n- `status: \"DRAFT\"`\n- Full document type information\n- Current version details"
          },
          "response": []
        }
      ]
    }
  ]
}
